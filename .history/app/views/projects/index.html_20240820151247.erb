
<div style="display: flex; justify-content: space-around;">
  <h1 style="margin: 0">Projects</h1>
<div><%= current_user.role %></div>
<%= button_to "Logout", destroy_user_session_path, method: :delete %>
</div>

<hr />
<% if can? :create, Project%>
<div><%= link_to "New project", new_project_path %></div>
<%end%>
<%# search  %>
<!-- app/views/projects/index.html.erb -->
<%= form_with url: search_projects_path, method: :post do |form| %>
  <%= form.search_field%>
  <div id="dropdown" data-search-target="dropdown" class="dropdown"></div>
<% end %>



<%# end %>
<div style="display: flex; justify-content: center;">
  <table style="width: 80%; border-collapse: collapse; border: 1px solid;">
    <thead>
      <tr style="border: 1px solid">
        <th style="border: 1px solid; padding: 8px;">Name</th>
        <th style="border: 1px solid; padding: 8px;">Description</th>
        <th style="border: 1px solid; padding: 8px;">Show</th>
      </tr>
    </thead>
    <tbody>
      <% @projects.each do |project| %>      
      <% if project&.users&.first&.id == current_user.id %>
        <tr style="border: 1px solid; background-color: #f2f2f2">
          <td style="border: 1px solid; padding: 8px;"><%= project.id%>.<%= project.name %></td>
          <td style="border: 1px solid; padding: 8px;"><%= project.description %></td>
          <td colspan="2" style="text-align: center; padding: 8px;">
            <%= link_to "Show this project", project %>
          </td>
        </tr>
      <%else%>
        <tr style="border: 1px solid">
          <td style="border: 1px solid; padding: 8px;"><%= project.id%>.<%= project.name %></td>
          <td style="border: 1px solid; padding: 8px;"><%= project.description %></td>
          <td colspan="2" style="text-align: center; padding: 8px;">
            <%= link_to "Show this project", project %>
          </td>
        </tr>
      <%end%>
      <% end %>
    </tbody>
  </table>
</div>
<%if @bugs!= []%>
<h1>Bugs</h1>
<div id="bugs">
  <% @bugs.each do |bug| %>
    <%= render bug %>
    <p>
      <%= button_to "Resolve this bug", status_update_project_bug_path(@project, bug), turbo_method: :post %>
    </p>
  <% end %>
</div>
<%end%>



